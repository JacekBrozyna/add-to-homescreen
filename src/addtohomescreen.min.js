!function(o,s,e){var t="com.love2dev.addtohome",i=localStorage.getItem(t);if(!i||!i.added){o.addEventListener("beforeinstallprompt",function(o){d=o}),o.addEventListener("appinstalled",function(o){n.doLog("a2hs","installed")});var n,a,r={},l={title:"Install this Progressive Web App?"};u.defaults={appID:t,appName:"Progressive Web App",debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,minSessions:0,startDelay:1,lifespan:15,displayPace:1440,displayNextPrime:!1,maxDisplayCount:0,validLocation:[],onInit:null,onShow:null,onRemove:null,onAdd:null,onPrivate:null,autoHide:10,athWrapper:".ath-viewport",showClasses:["animated","d-block"],showClass:"d-block",hideClass:"d-none",promptDlg:{body:".modal-body",title:".modal-title",footer:".modal-footer",cancel:".btn-cancel",install:".btn-install",action:{ok:"Install",cancel:"Not Now"}},prompt:{native:{showClasses:["fadeInUp","right-banner"],action:{ok:"Install",cancel:"Not Now"}},edge:{showClasses:["edge-wrapper","animated","fadeIn","d-block","right-banner"],imgs:[{src:"imgs/edge-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},iphone:{showClasses:["iphone-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/ios-safari-share-button-highlight.jpg",alt:"Tap the Share Icon"},{src:"imgs/iphone-a2hs-swipe-to-right.jpg",classes:["animated","fadeIn","overlay-1","delay-4s"],alt:"Swipe to the right"},{src:"imgs/iphone-a2hs-icon-highlight.jpg",classes:["animated","fadeIn","overlay-2","delay-7s"],alt:"Tap the Add to Homescreen Icon"}]},ipad:{showClasses:["ipad-wrapper","animated","fadeInUp","d-block"],imgs:[{src:"imgs/safari-ipad-share-a2hs-right.jpg",alt:"Tap the Add to Homescreen Icon"}]},firefox:{showClasses:["firefox-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/firefox-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},samsung:{showClasses:["samsung-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/samsung-internet-a2hs-icon.png",alt:"Tap the Add to Homescreen Icon"}]},opera:{showClasses:["opera-home-screen-wrapper","animated","fadeIn","d-block"],imgs:[{src:"imgs/opera-add-to-homescreen.png",alt:"Tap the Add to Homescreen Icon"}]}}},a=o.navigator.userAgent,r.inPrivate=!("localStorage"in o),r.isIDevice=/iphone|ipod|ipad/i.test(a),r.isSamsung=/Samsung/i.test(a),r.isFireFox=/Firefox/i.test(a),r.isOpera=/opr/i.test(a),r.isEdge=/edg/i.test(a),r.isFireFox&&(r.isFireFox=/android/i.test(a)),r.isOpera&&(r.isOpera=/android/i.test(a)),r.isChromium="onbeforeinstallprompt"in o,r.isInWebAppiOS=!0===o.navigator.standalone,r.isInWebAppChrome=o.matchMedia("(display-mode: standalone)").matches,r.isMobileSafari=r.isIDevice&&a.indexOf("Safari")>-1&&a.indexOf("CriOS")<0,r.isStandalone=r.isInWebAppiOS||r.isInWebAppChrome,r.isiPad=r.isMobileSafari&&a.indexOf("iPad")>-1,r.isiPhone=r.isMobileSafari&&-1===a.indexOf("iPad"),r.isCompatible=r.isChromium||r.isMobileSafari||r.isSamsung||r.isFireFox||r.isOpera;var d,p={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1,sessions:0,nextSession:0};i=i?JSON.parse(i):p,u.removeSession=function(o){localStorage.removeItem(o||u.defaults.appID)},u.doLog=function(o){this.options.logging&&(console.log(o),s.querySelector(".log-target").innerText+=o+"\r\n")},r.closePrompt=function(){var o=s.querySelector(n.options.athWrapper);o&&o.classList.remove(...n.options.showClasses)},r.handleInstall=function(o){return d?(r.closePrompt(),c()):m(),!1},u.Class=function(o){this.doLog=u.doLog,this.options=Object.assign({},u.defaults,o),s.querySelector("[rel='manifest']")||(r.isCompatible=!1),navigator.serviceWorker.getRegistration().then(g)},u.Class.prototype={_canPrompt:e,canPrompt:function(){if(this._canPrompt!==e)return this._canPrompt;if(this._canPrompt=!1,!("serviceWorker"in navigator))return this.doLog("Add to homescreen: not displaying callout because service workers are not supported"),!1;if(r.inPrivate)return this.doLog("Add to homescreen: not displaying callout because using Private browsing"),!1;if(!r.isCompatible)return this.doLog("Add to homescreen: not displaying callout because device not supported"),!1;if(this.options.onPrivate&&this.options.onPrivate.call(this),Date.now()-i.lastDisplayTime<6e4*this.options.displayPace)return this.doLog("Add to homescreen: not displaying callout because displayed recently"),!1;if(this.options.maxDisplayCount&&i.displayCount>=this.options.maxDisplayCount)return this.doLog("Add to homescreen: not displaying callout because displayed too many times already"),!1;for(var o=!this.options.validLocation.length,t=this.options.validLocation.length;t--;)if(this.options.validLocation[t].test(s.location.href)){o=!0;break}return o?i.sessions<this.options.minSessions?(this.doLog("Add to homescreen: not displaying callout because not enough visits"),!1):this.options.nextSession&&this.options.nextSession>0&&i.sessions>=this.options.nextSession?(this.doLog("Add to homescreen: not displaying callout because waiting on session "+this.options.nextSession),!1):i.optedout?(this.doLog("Add to homescreen: not displaying callout because user opted out"),!1):i.added?(this.doLog("Add to homescreen: not displaying callout because already added to the homescreen"),!1):r.isStandalone?(i.added||(i.added=!0,this.updateSession(),this.options.onAdd&&this.options.onAdd.call(this)),this.doLog("Add to homescreen: not displaying callout because in standalone mode"),!1):!i.returningVisitor&&(i.returningVisitor=!0,this.updateSession(),this.options.skipFirstVisit)?(this.doLog("Add to homescreen: not displaying callout because skipping first visit"),!1):(this._canPrompt=!0,!0):(this.doLog("Add to homescreen: not displaying callout because not a valid location"),!1)},show:function(o){this.shown?this.doLog("Add to homescreen: not displaying callout because already shown on screen"):(this.shown=!0,i.lastDisplayTime=Date.now(),i.displayCount++,n.options.displayNextPrime&&(i.nextSession=function(o){for(;;){var s=!0;o+=1;for(var e=Math.sqrt(o),t=2;t<=e;t++)if(o%t==0){s=!1;break}if(s)return o}}(i.session)),this.updateSession(),"interactive"===s.readyState||"complete"===s.readyState?this._delayedShow():s.onreadystatechange=function(){"complete"===s.readyState&&this._delayedShow()})},_delayedShow:function(o){setTimeout(this._show.bind(this),1e3*this.options.startDelay+500)},_show:function(){var o=h(),e=s.querySelector(n.options.athWrapper);if(e&&!i.optedout){e.classList.remove(n.options.hideClass);var t=Object.assign({},l,n.options.prompt[o]);t.showClasses?t.showClasses=t.showClasses.concat(n.options.showClasses):t.showClasses=n.options.showClasses,e.classList.add(...t.showClasses);e.querySelector(n.options.promptDlg.body);var a=e.querySelector(n.options.promptDlg.title),d=e.querySelector(n.options.promptDlg.footer),p=e.querySelector(n.options.promptDlg.cancel),c=e.querySelector(n.options.promptDlg.install);a&&(a.innerText=t.title),d.classList.remove(n.options.hideClass),c.addEventListener("click",r.handleInstall),c.classList.remove(n.options.hideClass),c.innerText=t.action&&t.action.ok?t.action.ok:n.options.promptDlg.action.ok,p.addEventListener("click",r.closePrompt),p.classList.remove(n.options.hideClass),p.innerText=t.action&&t.action.cancel?t.action.cancel:n.options.promptDlg.action.cancel}this.options.autoHide&&this.options.autoHide>0&&setTimeout(this.autoHide,1e3*this.options.autoHide),this.options.onShow&&this.options.onShow.call(this)},autoHide:function(){var o=h(),e=s.querySelector(n.options.athWrapper);if(e){var t=n.options.prompt[o];t.showClasses=t.showClasses.concat(n.options.showClasses),e.classList.remove(...t.showClasses),e.classList.add(n.options.hideClass)}},updateSession:function(){localStorage.setItem(this.options.appID,JSON.stringify(i))},clearSession:function(){i=p,this.updateSession()},optOut:function(){i.optedout=!0,this.updateSession()},optIn:function(){i.optedout=!1,this.updateSession()},clearDisplayCount:function(){i.displayCount=0,this.updateSession()}},o.addToHomescreen=u}function c(){return d.prompt().then(function(o){return d.userChoice}).then(function(o){i.added="accepted"===o.outcome,i.added?n.doLog("User accepted the A2HS prompt"):(i.optedout=!0,n.doLog("User dismissed the A2HS prompt")),n.updateSession(),d=null}).catch(function(o){n.doLog(o),m(!0)})}function h(o){return r.isChromium&&o===e&&!o?"native":r.isFireFox?"firefox":r.isiPad?"ipad":r.isiPhone?"iphone":r.isOpera?"opera":r.isSamsung?"samsung":r.isEdge?"edge":""}function m(o){var e=h(),t=s.querySelector(n.options.athWrapper);if(t)if(!o&&"native"===e&&d)r.closePrompt(),c();else{var i=Object.assign({},l,n.options.prompt[e]),a=t.querySelector(n.options.promptDlg.body),p=t.querySelector(n.options.promptDlg.footer);t.querySelector(n.options.promptDlg.cancel),t.querySelector(n.options.promptDlg.install);if(i.imgs&&i.imgs.length>0)for(var m=0;m<i.imgs.length;m++){var u=new Image;u.src=i.imgs[m].src,u.alt=i.imgs[m].alt,i.imgs[m].classes&&u.classList.add(...i.imgs[m].classes),u.classList.add(n.options.showClass),a.appendChild(u)}p.classList.add(n.options.hideClass)}}function u(o){return n=n||new u.Class(o)}function g(s){n.sw=s,n.sw||(r.isCompatible=!1),i.sessions+=1,n.updateSession(),n.options&&n.options.debug&&void 0===n.options.logging&&(n.options.logging=!0),n.options.mandatory=n.options.mandatory&&("standalone"in o.navigator||n.options.debug),n.options.modal=n.options.modal||n.options.mandatory,n.options.mandatory&&(n.options.startDelay=-.5),n.options.debug&&(r.isCompatible=!0),n.options.onInit&&n.options.onInit.call(n),n.options.autostart&&(n.doLog("Add to homescreen: autostart displaying callout"),n.canPrompt()&&n.show())}}(window,document);